version: "3.1"

# Slot definition. Slots refer to actions, entities, and intents defined below.
slots:
  user_location:
    type: text
    influence_conversation: false
    mappings:
      - type: from_entity
        entity: city
        intent:
          - inform_location
          - ask_weather_in_location

  mapped_location:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
        action: action_request_location

  mapped_latitude:
    type: float
    influence_conversation: false
    mappings:
      - type: custom
        action: action_request_location

  mapped_longitude:
    type: float
    influence_conversation: false
    mappings:
      - type: custom
        action: action_request_location

  weather:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
        action: action_request_weather

  temperature:
    type: float
    influence_conversation: false
    mappings:
      - type: custom
        action: action_request_weather

  cloudiness:
    type: float
    influence_conversation: false
    mappings:
      - type: custom
        action: action_request_weather

  wind_speed:
    type: float
    influence_conversation: false
    mappings:
      - type: custom
        action: action_request_weather

  # TODO: Implement default value and unit conversion.
  temperature_unit:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
        action: action_request_weather

# Action definition.
actions:
  - action_request_location
  - action_request_weather

# Entity definition.
entities:
  - city

# Intent definition.
intents:
  - greet
  - goodbye
  - affirm
  - deny
  - bot_challenge
  - thanks
  - ask_weather
  - inform_location
  - ask_weather_in_location
  - ask_temperature
  - ask_cloudiness
  - ask_wind_speed

# Response definition.
responses:
  utter_greet:
  - text: "Hey! How are you?"

  utter_goodbye:
  - text: "Bye"

  utter_iamabot:
  - text: "I am a bot, powered by Rasa."

  utter_welcome:
  - text: "You are welcome!"

  utter_ask_location:
  - text: "In which city?"
  - text: "Where do you want to know the weather?"

  utter_location_mapping:
  - text: "Your requested location {user_location} was mapped to {mapped_location}."

  utter_weather:
  - text: "The weather in {mapped_location} is {weather} at {temperature} {temperature_unit} and {wind_speed} m/s wind speed."

  utter_temperature:
  - text: "The temperature in {mapped_location} is {temperature} {temperature_unit}."

  utter_cloudiness:
  - text: "The cloudiness in {mapped_location} is {cloudiness}%."

  utter_wind_speed:
  - text: "The wind speed in {mapped_location} is {wind_speed} m/s."

# Session configuration.
session_config:
  session_expiration_time: 60
  carry_over_slots_to_new_session: true
